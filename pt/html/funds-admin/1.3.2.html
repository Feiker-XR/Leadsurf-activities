<!DOCTYPE HTML>
<html lang="en-US" class="html-content">
<head>
	<meta charset="UTF-8">
	<title>1.3唯一附言管理</title>
	<link rel="stylesheet" href="../images/common/base.css" />
	<link rel="stylesheet" href="../images/admin/admin.css" />
	<script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="../js/phoenix.base.js"></script>
	<script type="text/javascript" src="../js/phoenix.Class.js"></script>
	<script type="text/javascript" src="../js/phoenix.Event.js"></script>
	<script type="text/javascript" src="../js/phoenix.util.js"></script>
	<script type="text/javascript" src="../js/phoenix.Mask.js"></script>
	<script type="text/javascript" src="../js/phoenix.MiniWindow.js"></script>
	<script type="text/javascript" src="../js/phoenix.Message.js"></script>
</head>
<body>
	<div class="menu">
		<div class="menu-logo"></div>
		<ul class="menu-list">
			<li><a href="">首页</a></li>
			<li><a href="">全局</a></li>
			<li><a href="">用户</a></li>
			<li><a href="">游戏</a></li>
			<li><a href="">资金</a></li>
			<li><a href="">市场促销</a></li>
			<li><a href="">统计</a></li>
			<li><a href="">内容</a></li>
			<li><a href="">权限</a></li>
		</ul>
		<div class="menu-quit"><a href="">退出</a><i class="ico-user"></i>你好，vava</div>
	</div>
	<div class="col-content">
		<div class="col-side">
			<dl class="nav">
				<dt>充值相关</dt>
				<dd><a href="">异常充值处理</a></dd>
				<dd><a href="">充值相关配置</a></dd>
				<dd><a href="">唯一附言管理</a></dd>
				<dt>提现相关</dt>
				<dd><a href="">风险提现处理</a></dd>
				<dd><a href="#">提现相关处理</a></dd>
				<dt>人工资金操作</dt>
				<dd><a href="#">人工资金操作审核流程</a></dd>
				<dt>银行卡相关</dt>
				<dd class="current"><a href="#">银行管理</a></dd>
				<dd><a href="#">用户银行卡绑定管理</a></dd>
				<dd><a href="#">银行卡黑名单管理</a></dd>
				<dt>统计报表</dt>
				<dd><a href="#">充值明细报表</a></dd>
				<dd><a href="#">提现明细报表</a></dd>
				<dd><a href="#">充提报表</a></dd>
				<dd><a href="#">总代每日报表</a></dd>
				<dd><a href="#">自动收款明细报表</a></dd>
				<dt>转账相关</dt>
				<dd><a href="#">转账明细</a></dd>
				<dd><a href="#">转账限额配置</a></dd>
			</dl>
		</div>
		<div class="col-main annex-setting">
			<div class="col-content">
				<div class="col-main">
					<div class="main">
						<div class="ui-tab-title clearfix">
							<ul>
								<li><a href="1.3.html">唯一附言管理</a></li>
								<li class="current"><a href="1.3.2.html">唯一附言回收管理</a></li>
								<li><a href="1.3.1.html">配置管理</a></li>
							</ul>
						</div>
						<h3 class="ui-title batch-operation">
							<span class="batch">批量操作</span>
							<a href="#" class="recover-btn btn btn-small">回收<b class="btn-inner"></b></a>
							<a href="#" class="report-download btn btn-small">报表下载<b class="btn-inner"></b></a>
						</h3>
								<table class="table table-info table-function info-list">
									<thead>
										<tr>
											<th id="J-select-all">反选</th>
											<th>唯一附言</th>
											<th>最后绑定用户</th>
											<th>解绑时间</th>
											<th>操作</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td class="select-checked"><input type="checkbox" data-user="vava(300)" class="recover-check" name="annex" /></td>
											<td>ssdyqm</td>
											<td>xiaodian</td>
											<td>2013-02-02 10:20:30</td>
											<td>
												<a class="recover" data-user='vava(300)'  href="#">回收</a>
											</td>
										</tr>
										<tr>
											<td class="select-checked"><input type="checkbox" data-user="vava(300)" class="recover-check" name="annex" /></td>
											<td>ssdyqm</td>
											<td>xiaodian</td>
											<td>2013-02-02 10:20:30</td>
											<td>
												<a class="recover" data-user='vava(300)'  href="#">回收</a>
											</td>
										</tr>
										<tr>
											<td class="select-checked"><input type="checkbox" data-user="vava(300)" class="recover-check" name="annex" /></td>
											<td>ssdyqm</td>
											<td>xiaodian</td>
											<td>2013-02-02 10:20:30</td>
											<td>
												<a class="recover" data-user='vava(300)'  href="#">回收</a>
											</td>
										</tr>
										<tr>
											<td class="select-checked"><input type="checkbox" data-user="vava(300)" class="recover-check" name="annex" /></td>
											<td>ssdyqm</td>
											<td>xiaodian</td>
											<td>2013-02-02 10:20:30</td>
											<td>
												<a class="recover" data-user='vava(300)'  href="#">回收</a>
											</td>
										</tr>
										<tr>
											<td class="select-checked"><input type="checkbox" data-user="vava(300)" class="recover-check" name="annex" /></td>
											<td>ssdyqm</td>
											<td>xiaodian</td>
											<td>2013-02-02 10:20:30</td>
											<td>
												<a class="recover" data-user='vava(300)'  href="#">回收</a>
											</td>
										</tr>
										<tr>
											<td class="select-checked"><input type="checkbox" data-user="vava(300)" class="recover-check" name="annex" /></td>
											<td>ssdyqm</td>
											<td>xiaodian</td>
											<td>2013-02-02 10:20:30</td>
											<td>
												<a class="recover" data-user='vava(300)'  href="#">回收</a>
											</td>
										</tr>
									</tbody>
								</table>
								<div class="page-wrapper">
									<span class="page-text">
										<span class="lower">共102条记录</span>
									</span>
									<div class="page page-right">
										<a href="#" class="prev">上一步</a>
										<a href="#">1</a>
										<a href="#">2</a>
										<a href="#" class="current">3</a>
										<a href="#">4</a>
										<a href="#">5</a>
										<a href="#">6</a>
										<a href="#">7</a>
										<a href="#">8</a>
										<a href="#">9</a>
										<a href="#">...</a>
										<a href="#" class="next">下一步</a>
										<span class="page-few">到第 <input type="text" value="" class="input"> /100页</span>
										<input type="button" value="确 认" class="page-btn">
									</div>
								</div>
								
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

<script>
(function($){
	var message = new phoenix.Message,
		selectAllDom = $('#J-select-all'),
		batchReBind = $('.batch-operation .recover-btn'),
		batchReport = $('.batch-operation .report-download'),
		checkBoxDom = $('input[name="annex"]');

	//根据type类型来进行判断
	//bind为绑定
	//bind-user为用户绑定
	//默认为绑定
	countCheckedNum = function(type) {
		var count = 0,
			type = 'recover-check',
			dom = $('.info-list' +' .'+type);

		$.each(dom, function(index, val) {
			var result = $(this).prop('checked');

			if(result) {
				count++;
			}
		});

		return count || -1;
	}

	//获取用户ID
	getUserId = function() {
		var saveArray =  [],
			type = 'recover-check',
			dom = $('.info-list' +' .'+ type);

		$.each(dom, function(index, val) {
			var result = $(this).prop('checked');

			if(result) {
				saveArray.push($(this).attr('data-user'));
			}
		});

		return saveArray;
	}

	//回收
	batchReBind.on('click', function() {
		var count = countCheckedNum();

		if(count != -1) {

			message.show({
				mask: true,
				content: '<div class="bd text-center"><div class="pop-title"><i class="ico-waring"></i><h4 class="pop-text">确认回收？</h4></div></div>',
				confirmIsShow: true,
				confirmFun: function() {
					$.ajax({
						url: '#',
						type: 'GET',
						dataType: 'json',
						data: {userid: getUserId('bind')},
						success: function() {

							window.location.reload();
						}
					});
				}
			});

			
		}else{
			message.show({
				mask: true,
				content: '<div class="bd text-center"><div class="pop-title"><i class="ico-waring"></i><h4 class="pop-text">请先选择回收对象</h4></div></div>',
				cancelIsShow: true,
				cancelFun: function() {
					this.hide();
				}
			});
		}
	});

	//报表下载
	batchReport.on('click', function() {
		var count = countCheckedNum();


	});

	//全选按钮
	selectAllDom.on('click', function() {


		$.each(checkBoxDom, function(index, val) {
			var result = $(this).prop('checked');
			
			if(result) {
				$(this).removeAttr('checked');
			}else {
				$(this).prop('checked', true);
			}

		});
	});

	//解除绑定
	$('.recover').on('click', function() {
		var address = $(this).attr('data-user');

		message.show({
			mask: true,
			content: '<div class="bd text-center"><div class="pop-title"><i class="ico-waring"></i><h4 class="pop-text">确认回收？</h4></div></div>',
			confirmIsShow: true,
			confirmFun: function() {
				
				$.ajax({
					url: '#',
					type: 'GET',
					dataType: 'json',
					data: {userid: address},
					success: function() {
						window.location.reload();
					}
				});
			},
			cancelIsShow: true,
			cancelFun: function() {
				this.hide();
			}
		});
	});

	//解除用户锁定
	$('.relock-user').on('click', function() {
		var address = $(this).attr('data-user');

		message.show({
			mask: true,
			content: '<div class="bd text-center"><div class="pop-title"><i class="ico-waring"></i><h4 class="pop-text">确认解除用户锁定？</h4></div></div>',
			confirmIsShow: true,
			confirmFun: function() {
				
				$.ajax({
					url: '',
					type: 'GET',
					dataType: 'json',
					data: {userid: address},
					success: function() {
						window.location.reload();
					}
				});
			},
			cancelIsShow: true,
			cancelFun: function() {
				this.hide();
			}
		});
	});



})(jQuery);
</script>

</body>
</html>