<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>我要充值</title>
	<link rel="stylesheet" href="../images/common/base.css" />
	<link rel="stylesheet" href="../images/common/js-ui.css" />
	<link rel="stylesheet" href="../images/funds/funds.css" />
	<script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="../js/phoenix.base.js"></script>
	<script type="text/javascript" src="../js/phoenix.Class.js"></script>
	<script type="text/javascript" src="../js/phoenix.Event.js"></script>
	<script type="text/javascript" src="../js/phoenix.util.js"></script>
	<script type="text/javascript" src="../js/phoenix.Mask.js"></script>
	<script type="text/javascript" src="../js/phoenix.MiniWindow.js"></script>
</head>
<body>
	
	<!-- toolbar start -->
	<div class="bg-toolbar"></div>
	<div class="toolbar">
		<div class="g_33">
				<ul class="menu">
					<li class="user hover">
						<a href="#">您好，VIC<i class="tri"></i></a>
						<div class="menu-nav" style="display:none;">
							<i class="tri"></i>
							<a href="">游戏记录</a>
							<a href="">报表管理</a>
							<a href="">资金明细</a>
							<a href="">安全中心</a>
						</div>
					</li>
					<li class="msg">
						<a href="#" class="msg-title">12</a>
						<div class="msg-box" style="display:none;">
							<div class="msg-hd"><i class="tri"></i><a href="#" class="more">更多</a>我的未读消息<strong>（12）</strong></div>
							<div class="msg-bd">
								<a href="">这里是消息提示提示消息</a>
								<a href="">这里是消息提示提示消息</a>
								<a href="">这里是消息提示提示消息</a>
								<a href="">这里是消息提示提示消息这里是消息提示提示消息这里是消息提示提示消息这里是消息提示提示消息</a>
							</div>
						</div>
					</li>
					<li class="balance">余额：10000.00</li>
					<li class="recharge"><a href="#">充值</a></li>
					<li class="withdrawals"><a href="#">提现</a></li>
					<li class="quit"><a href="#">退出</a></li>
				</ul>
		</div>
	</div>
	<!-- toolbar end -->
	<!-- header start -->
	<div class="header">
		<div class="g_33">
			<h1 class="logo"><a title="首页" href="#">PH158</a></h1>
			<div class="service">
				<a title="客服" class="link-service" href="#">客服</a>
				<a title="帮助" class="link-help" href="#">帮助</a>
			</div>
		</div>
	</div>
	<!-- header end -->
	
	<div class="g_33 common-main">
		<div class="g_5">
			<div class="common-side">
				<div class="nav-side">
					<dl class="side-bet">
						<dt class="title">投注管理</dt>
						<dd><a href="../bet/1.1bet-bets.html">游戏记录</a></dd>
						<dd><a href="../bet/1.7bet-chas.html">追号记录</a></dd>
						<dd><a href="../bet/1.7bet-chas.html">账户明细</a></dd>
					</dl>
					<dl class="side-safe">
						<dt class="title">账户安全</dt>
						<dd><a href="../ucenter/2.3safe-safe.html">安全中心</a></dd>
						<dd><a href="../ucenter/2.3safe-safe.html">银行卡管理</a></dd>
						<dd><a href="../ucenter/2.1safe-personal.html">个人资料</a></dd>
						<dd><a href="../ucenter/2.11-2.12safe-change-pwd.html">密码管理</a></dd>
					</dl>
					<dl class="side-service">
						<dt class="title">服务</dt>
						<dd><a href="../service/3.1service-inbox.html">积分</a></dd>
						<dd><a href="../service/3.1service-inbox.html">红包</a></dd>
						<dd><a href="../service/3.1service-inbox.html">站内信</a></dd>
					</dl>
					<dl class="side-proxy">
						<dt class="title">代理中心</dt>
						<dd><a href="../proxy/4.1proxy-index.html">卡户</a></dd>
						<dd><a href="../proxy/4.23proxy-account-center-management.html">开户中心</a></dd>
						<dd><a href="../proxy/4.2proxy-customer-management.html">客户管理</a></dd>
						<dd><a href="../proxy/4.15proxy-report-query.html">报表查询</a></dd>
					</dl>
					<dl class="side-funds">
						<dt class="title">代理中心</dt>
						<dd><a href="../proxy/4.1proxy-index.html">我要充值</a></dd>
						<dd><a href="../proxy/4.23proxy-account-center-management.html">我要提现</a></dd>
						<dd><a href="../proxy/4.2proxy-customer-management.html">上下级转账</a></dd>
						<dd><a href="../funds/6.html">唯一附言</a></dd>
					</dl>
				</div>
			</div>
		</div>
		
		
		<div class="g_28 g_last">
			<div class="common-content">
				<div class="title">我要充值</div>
				<div class="ui-tab-title tab-title-bg clearfix">
					<ul>
						<li>网银汇款</li>
						<li class="current">快捷充值</li>
						<li>财付通充值</li>
					</ul>
				</div>
				<div class="content bank-select">
					<div class="step">
						<table class="step-table">
							<tbody>
								<tr>
									<td class="current"><div class="con">1.选择银行并填写金额</div></td>
									<td><div class="tri"><div class="con">2.确认充值信息</div></div></td>
									<td><div class="tri"><div class="con">3.登录网上银行汇款</div></div></td>
								</tr>
							</tbody>
						</table>
					</div>
					<ul class="ui-form bank-select-from">
						<li class="bank-select-from-li">
							<label class="ui-label">发卡银行：</label>
							<div class="bank-more">
								<div class="bank-label">
									<span class="bank-drop-text"  id="selectBank">- 请选择银行 -</span>
									<a class="bank-drop" href="javascript:void(0);" ><i class="ico-down" id="icoName"></i></a>
								</div>
								<div class="ui-check" id="selectBankEr" style="display: none;"><i class="error"></i>请选择银行</div>
								<div class="bank-more-content" style="display: none;">
									<div class="bank-list" id="banklistinfo">
                                   		<input type="hidden" name="status" id="bankselect" value="TENPAY"> 
										<span class="ico-bank ICBC" name="ICBC" max="190" min="20" title="中国工商银行充值限额：最低20,最高190"></span>
										<span class="ico-bank CMB" name="CMB" max="190" min="10" title="招商银行充值限额：最低10,最高190"></span>
										<span class="ico-bank CCB" name="CCB" max="190" min="10" title="建设银行充值限额：最低10,最高190"></span>
										<span class="ico-bank ABC" name="ABC" max="190" min="10" title="农业银行充值限额：最低10,最高190"></span>
										<span class="ico-bank BOC" name="BOC" max="190" min="10" title="中国银行充值限额：最低10,最高190"></span>
										<span class="ico-bank COMM" name="COMM" max="190" min="10" title="交通银行充值限额：最低10,最高190"></span>
										<span class="ico-bank CMBC" name="CMBC" max="190" min="10" title="民生银行充值限额：最低10,最高190"></span>
										<span class="ico-bank CITIC" name="CITIC" max="190" min="10" title="中信银行充值限额：最低10,最高190"></span>
										<span class="ico-bank SPDB" name="SPDB" max="190" min="10" title="浦发银行充值限额：最低10,最高190"></span>
										<span class="ico-bank PSBC" name="PSBC" max="190" min="10" title="邮政储蓄银行充值限额：最低10,最高190"></span>
										<span class="ico-bank CEB" name="CEB" max="190" min="10" title="光大银行充值限额：最低10,最高190"></span>
										<span class="ico-bank SPABANK" name="SPABANK" max="190" min="10" title="平安银行充值限额：最低10,最高190"></span>
										<span class="ico-bank GDB" name="GDB" max="190" min="10" title="广发银行充值限额：最低10,最高190"></span>
										<span class="ico-bank HXBANK" name="HXBANK" max="190" min="10" title="华夏银行充值限额：最低10,最高190"></span>
										<span class="ico-bank TENPAY ico-bank-current" name="TENPAY" max="190" min="10" title="财付通充值限额：最低10,最高190"></span>				
									</div>
								</div>
							</div>
						</li>
						 <li class="ui-text">
							<div class="prompt" ><div name="initialMoney">充值金额：单笔最低充值金额为<span name="txtminmoney"></span>元，最高<span name="txtmaxmoney"></span>元<br /></div>充值时限：请在30分钟内完成充值</div>
						</li>
						<li >
							<label class="ui-label">充值金额：</label>
							<input type="text" class="input w-4" value="" disabled="disabled" id="chargeamount" name="chargeamount"  autocomplete="off" > 
                            <span class="ui-text-info">元</span>		
							<i class="check-right"></i>
                            <div name="initialMoney">			
                                <span class="ui-prompt"><div  id="div_pro" style="display:none">充值限额：最低<span name="txtminmoney"></span>元，最高<span name="txtmaxmoney"></span>元</div></span>									
                                <span class="ui-check"><i class="error"></i>充值限额：最低<span name="txtminmoney"></span>元，最高<span name="txtmaxmoney"></span>元</span>
                             </div>	
						</li>

						<li class="ui-text" style="margin-top:-20px;">
							<span class="ui-singleline" id="chineseMoney"></span>
						</li>	
						<li class="ui-btn"><a href="javascript:void(0);" class="btn btn-important">下一步<b class="btn-inner"></b></a></li>
					</ul>
					<div style="padding:20px;color:#999;">
						注：您还在为每次充值填写不一样的附言而烦恼吗？  <a href="#">立即设置唯一附言</a>，从此只需记一个专属您自己的附言，充值更方便。
					</div>
				</div>
			</div>
		</div>
		
	</div>
	<div class="footer footer-important">
		<div class="g_33">
			<span class="copy">&copy; 2001-2012 591PH. All right reserved. 凤凰游戏平台版权所有</span><a href="#">帮助中心</a> | <a href="#">在线客服</a> | <a href="#">游戏介绍</a> | <a href="#">下载客户端</a> | <a href="#">翻墙工具</a>
		</div>
	</div>






<script  src="http://static.rfonlineedu.com:888/static/js/phoenix.Common.js"></script>


<script type="text/tpl" id="J-template-checkstatus">
<div>
	<p class="wd-title">对不起，您尚有一笔充值申请未完成，请完成后再发起</p>
	<div>
		<table width="100%" border="0" cellspacing="10" cellpadding="0">
		  <tr>
			<td align="right" width="130" class="wd-td-bold">充值银行：</td>
			<td><#=bankFrom#></td>
		  </tr>
		  <tr>
			<td align="right" class="wd-td-bold">充值金额：</td>
			<td><#=money#></td>
		  </tr>
		  <tr>
			<td align="right" class="wd-td-bold">收款银行：</td>
			<td><#=bankTo#></td>
		  </tr>
		  <tr>
			<td align="right" class="wd-td-bold">收款账户名：</td>
			<td><#=name#></td>
		  </tr>
		  <tr>
			<td align="right" class="wd-td-bold">收款Email地址：</td>
			<td><#=email#></td>
		  </tr>
		  <tr>
			<td align="right" class="wd-td-bold">附言：</td>
			<td><#=message#></td>
		  </tr>
		  <tr>
			<td align="right" class="wd-td-bold">开户行名称：</td>
			<td><#=bankOpen#></td>
		  </tr>
	  </table>
		<p class="wd-control-panel">
			您还可以 &nbsp;&nbsp;&nbsp;&nbsp;
			<a href="#" class="btn btn-important" id="J-button-order-cancel">撤销申请<b class="btn-inner"></b></a>
			&nbsp;&nbsp;&nbsp;&nbsp;
			<a href="#">充值记录</a>
		</p>
		<p class="wd-tip">
			* 如您已完成付款，请勿撤销，我们将尽快为您处理。
		</p>
	</div>
</div>
</script>
<script type="text/tpl" id="J-template-cancel-confirm">
<div>
	<p class="wd-title" style="text-align:center;">您的充值申请已撤销成功！</p>
		<p class="wd-control-panel">
			<a href="#" class="btn btn-important closeBtn">继续充值<b class="btn-inner"></b></a>
			&nbsp;&nbsp;&nbsp;&nbsp;
			<a href="#">充值记录</a>
		</p>
</div>
</script>
<script>
var enableRecharge = 1;
</script>

<script>
(function(){
	
	var minWindow = new phoenix.MiniWindow({cls:'ui-alert-custom'}),
	mask = phoenix.Mask.getInstance();
	minWindow.addEvent('beforeShow', function(){
		mask.show();
	});
	minWindow.addEvent('afterHide', function(){
		mask.hide();
	});
	
	var checkOrderStatus = function(){
		$.ajax({
			url:'checkOrderStatus.json',
			dataType:'json',
			async: false,
			success:function(data){
				//var data = {isSuccess:1, type:'', msg:'请求成功', data:{bankFrom:'充值银行名称', money:'充值金额', bankTo:'收款银行', name:'收款人', email:'收款Email地址', message:'附言', bankOpen:'开户行名称'}};
				if(Number(data['isSuccess']) == 1){
					var str = $('#J-template-checkstatus').html(),
						reg,
						p;
					for(p in data['data']){
						if(p == null){
							p = '';
						}
						reg = RegExp('<#=' + p + '#>', 'g');
						str = str.replace(reg, data['data'][p]);
					}
					$("#isCharged").val(1);
					minWindow.setTitle('温馨提示');
					minWindow.setContent(str);
					minWindow.show();
					$('#J-button-order-cancel').click(function(e){
						e.preventDefault();
						$.ajax({
							url:'/fund/cancleorder/',
							dataType:'json',
							async:false,
							cache:false,
							data:"chargeId="+$(this).attr('prevalue'),
							success:function(data){
								if(Number(data['isSuccess']) == 1){
									minWindow.hide();
									minWindow.setContent($('#J-template-cancel-confirm').html());
									minWindow.show();
								}else{
									alert(data['msg']);
								}
							}
						});
					});
					return true;
				}else{
					return false;
				}
			}
		});
	};
	
	var chargeamount,chargeamountPar,minmoney=0,maxmoney=0,form = $('#J-form');	
	errorTypes = ['chargeamount'],
	errorHas = {},
	setErrorNum = function(name, num){
	if(typeof errorHas[name] != 'undefined'){
		errorHas[name] += num;
		errorHas[name] = errorHas[name] < 0 ? 0 : (errorHas[name] > 1 ? 1 : errorHas[name]);
		}
	};
	$.each(errorTypes, function(){
		errorHas[this] = 0;
	});
	
	var getClolor=function(obj){
			var v=obj.value;
			if(v.indexOf(".")==-1)
			{
				
				if(v.length == 4)
				{
					$(obj).attr("style","color:green");
				}else if(v.length == 5)
				{
					$(obj).attr("style","color:red");
				}else if(v.length >= 6)
				{
					$(obj).attr("style","color:#6B238E");
				}else
				{
					$(obj).attr("style","color:#BDBDBD");
				}		
			}else if(v.indexOf(".")>0)
			{
				var vlist=v.split(".");
				if(vlist[0].length == 4)
				{
					$(obj).attr("style","color:green");
				}else if(vlist[0].length == 5)
				{
					$(obj).attr("style","color:red");
				}else if(vlist[0].length >= 6)
				{
					$(obj).attr("style","color:#6B238E");
				}else
				{
					$(obj).attr("style","color:#BDBDBD");
				}		
			}
	    }
	
	 // var cookicecodeB=$.cookie("selectbank"),cookicecode;	
	 // if(cookicecodeB!=null){ 
	 // 	 var cookicecode= phoenix.util.decodeBase64(cookicecodeB);
		//  $("#banklistinfo > span").each(function(){
		// 	if($(this).attr("name")==cookicecode){
		// 		 minmoney=$.trim($(this).attr("min"));				
		// 		 maxmoney=$.trim($(this).attr("max"));
		// 		 return;
		// 	}			
		//  }); 
		 
		//  //当后台禁用此银行，而上一笔又用此银行时，不保存此银行信息,清空cookice
		//  if(maxmoney !=0){
		// 	 $('#selectBank').removeAttr("style").removeAttr("class").addClass("ico-bank "+cookicecode).attr("title",cookicecode).html('');		
		// 	 $("#bankselect")[0].value=cookicecode;
		// 	 $('[name="initialMoney"],#div_pro').css("display","inline");
		// 	 $('[name="txtminmoney"]').html(minmoney);
		// 	 $('[name="txtmaxmoney"]').html(maxmoney);	
		// 	 $("#chargeamount").removeAttr("disabled");
		//  }else{
		// 	 $.cookie("selectbank", '', { expires: 7 }); 
		// 	 $('[name="initialMoney"]').css("display","none");	
		// }
	 // }else{	  $('[name="initialMoney"]').css("display","none");	}	
	 	
	var checkFn2 = function(obj){
		var me = obj,v = me.value,index;
		me.value = v = v.replace(/^\.$/g, '');		
		index = v.indexOf('.');
		if(index > 0){
			me.value = v = v.replace(/(.+\..*)(\.)/g, '$1');			
			if(v.substring(index+1,v.length).length>2){				
				me.value= v  = v.substring(0, v.indexOf(".") + 3);
			}
		}else
		{
			me.value = v = v.replace(/^0/g, '');
		}		
		me.value = v = v.replace(/[^\d|^\.]/g, '');
		me.value = v = v.replace(/^00/g, '0');				
	};
	var checkRechargeStatus = function(){
		if(enableRecharge ==0){
			minWindow.setTitle('温馨提示');
			minWindow.setContent('<div class="pop-title"><i class="ico-success"></i><h4 class="pop-text" style="color:#F00;">您帐号充值功能已被冻结，请联系您的上级代理或平台客服！</h4></div><div class="pop-btn"><a class="btn closeBtn" href="#">确定<b class="btn-inner"></b></a></div>');
			minWindow.show();
			return false;
		}
		return true;
	};
	//充值金额验证
	chargeamount = $('#chargeamount');
	chargeamountPar = chargeamount.parent();	
	chargeamount.blur(function(){
		var v = $.trim(this.value);
		/*if($("#bankselect")[0].value==''){				
			$('#chargeamount').val('');	
		}	*/
		checkFn2(this);
		checkform();
		if(checkOrderStatus()){
			die;
		}
	}).focus(function(){	
		if($("#bankselect")[0].value==''){				
			$('#selectBankEr').css('display', 'inline');	
		}	
		chargeamountPar.find('.ui-check').css('display', 'none');
		chargeamountPar.find('.ui-prompt').css('display', 'inline');
	}).keyup(function(){
		var v=this.value;
		var maxmoney=$($("[name='txtmaxmoney']")[0]).text()
		//var minmoney=$($("[name='txtminmoney']")[0]).text();
		if(Number(v)>maxmoney)
		{
			$(this).val(maxmoney);
		}
		checkFn2(this);
	    checkform();		
        $("#chineseMoney").html(changeMoneyToChinese(this.value));
	});
	
	
	$('.bank-more-content').css("display","none");
	$('.bank-more').css("min-height","45px");		
	$('#div_pro').css("display","inline");
	
	//数字校验，自动矫正不符合数学规范的数学(小数两位)
	var inputs =  $('#chargeamount'),checkFn;				
	checkFn = function(){
		var me = this,v = me.value,index;
		me.value = v = v.replace(/^\.$/g, '');		
		index = v.indexOf('.');
		if(index > 0){
			me.value = v = v.replace(/(.+\..*)(\.)/g, '$1');			
			if(v.substring(index+1,v.length).length>2){				
				me.value= v  = v.substring(0, v.indexOf(".") + 3);
			}
		}	
	    getClolor(this);
		me.value = v = v.replace(/[^\d|^\.]/g, '');
		me.value = v = v.replace(/^00/g, '0');				
	};
	inputs.keyup(checkFn);
	inputs.blur(checkFn);
		
	
	//当没有绑定银行卡时显示字，请选择银行
	$('#selectBank').css("display","inline-block").css("width","131px").css("text-align","center");		
	//储蓄卡充值
	$("#banklistinfo span").click(function () {
		if(checkOrderStatus()){
			die;
		}
		$("#banklistinfo span").removeClass("ico-bank-current");
		var txtstatus =$.trim($(this).attr("name"));	
		minmoney =$.trim($(this).attr("min"));
		maxmoney = $.trim($(this).attr("max"));		
		$(this).addClass("ico-bank ico-bank-current "+txtstatus);		
		$("#bankselect").attr("value", txtstatus);
		//alert($("#bankselect")[0].value);			
		//当有绑定银行,显示相应银行图片(动态绑定)
		$('#selectBank').removeAttr("style").removeAttr("class").addClass("ico-bank "+txtstatus).attr("title",txtstatus).html('');	
		$('.bank-more-content').css("display","none");
		$('.bank-more').css("min-height","45px");		
		$('#div_pro,[name="initialMoney"]').css("display","inline");
		$('#icoName').removeClass('ico-up').addClass('ico-down');
		$('[name="txtminmoney"]').html(minmoney);
		$('[name="txtmaxmoney"]').html(maxmoney);
		$("#chargeamount").removeAttr("disabled");
		if($("#bankselect")[0].value!=''){				
			$('#selectBankEr').css('display', 'none');
		}	
	});		
		
	$('#J-submit1').click(function(){
		$('#otherbank').css("display","inline");
		$('#J-submit1').css("display","none");
	});	
	
	$('#J-submit2').click(function(){
		$('#otherbank').css("display","none");
		$('#J-submit1').css("display","inline");			
	});		
		
	//银行卡展示与隐藏
	$('.bank-drop').click(function(){
		var classcss = $('#icoName').attr("class");		
		if(classcss=='ico-down'){
			$('#icoName').removeClass('ico-down').addClass('ico-up');			
			$('.bank-more-content').show();	
			$('#J-submit1').css("display","inline");
		}
		else{
			$('#icoName').removeClass('ico-up').addClass('ico-down');
			$('.bank-more').css("min-height","45px");
			$('.bank-more-content').css("display","none");
		} 		
	});	
		
	//表单检测
	checkform = function(){			
		if($.trim($('#chargeamount')[0].value) != "")
		{
			if((minmoney ==0 && maxmoney ==0) || $('#chargeamount')[0].value == '' || parseFloat($('#chargeamount')[0].value) > maxmoney || parseFloat($('#chargeamount')[0].value) < minmoney){
				chargeamountPar.find('.ui-check').css('display', 'inline');	
				chargeamountPar.find('.ui-prompt').css('display', 'none');
				chargeamountPar.parent().find('.check-right').css('display', 'none');
				setErrorNum('chargeamount', 1);		
			}	
			else{
				chargeamountPar.find('.ui-check').css('display', 'none');
				chargeamountPar.parent().find('.check-right').css('display', 'inline-block');
				setErrorNum('chargeamount', -1);
			}	
		}	
		else
		{
			chargeamountPar.find('.ui-check').css('display', 'inline');	
			chargeamountPar.find('.ui-prompt').css('display', 'none');
			chargeamountPar.parent().find('.check-right').css('display', 'none');
			setErrorNum('chargeamount', 1);	
		}
	}		
	 
	//表单提交校验
	$('#J-Submit').click(function(){
		form.submit();	
	});			
	
	form.submit(function(e){			
		var err = 0;	
		checkform();	
		$.each(errorTypes, function(){
			if(typeof errorHas[this] != 'undefined'){
				err += errorHas[this];
			}
		});
		
		if(err > 0){ 
			e.preventDefault(); 
			return false;	
		}	
		else if($("#bankselect")[0].value==''){
			alert("请选择银行");
			return false;
		}
		else{
			if(!checkRechargeStatus()){
				return false;
			}
			if(checkOrderStatus()){
				return false;
			}
			if($("#isCharged").val()=='1'){
				return false;
			}
			
			//所有验证通过后保存当前选中银行及大小金额放入
			var base64Bank= new phoenix.util.Base64Method();
			var bankSelect=base64Bank.encode($.trim($("#bankselect")[0].value));    			
			$.cookie("selectbank", bankSelect, { expires: 7 }); 			
			return true;
		}
	});
	checkRechargeStatus();
})();
</script>




















</body>

</html>