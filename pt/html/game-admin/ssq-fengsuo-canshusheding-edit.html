<!DOCTYPE HTML>
<html lang="en-US" class="html-content">
<head>
	<meta charset="UTF-8">
	<title>组三组六豹子盈亏详情  封锁数据</title>
	<link rel="stylesheet" href="../images/common/base.css" />
    <link rel="stylesheet" href="../images/common/js-ui.css" />
	<link rel="stylesheet" href="../images/admin/admin.css" />
	<style>
	.ui-label {height:24px;}
	.ui-form li {margin:5px 0;}
	</style>
    <script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="../js/jquery.tmpl.min.js"></script>
	<script type="text/javascript" src="../js/phoenix.base.js"></script>
	<script type="text/javascript" src="../js/phoenix.Class.js"></script>
	<script type="text/javascript" src="../js/phoenix.Event.js"></script>
	<script type="text/javascript" src="../js/phoenix.util.js"></script>
	<script type="text/javascript" src="../js/phoenix.Mask.js"></script>
	<script type="text/javascript" src="../js/phoenix.DatePicker.js"></script>
	<script type="text/javascript" src="../js/phoenix.SuperSearchGroup.js"></script>
	<script type="text/javascript" src="../js/phoenix.SuperSearch.js"></script>
	<script type="text/javascript" src="../js/phoenix.Tab.js"></script>
	<script type="text/javascript" src="../js/phoenix.MiniWindow.js"></script>
	<script type="text/javascript" src="../js/phoenix.Message.js"></script>
</head>
<body>
	<div class="menu">
		<div class="menu-logo"></div>
		<ul class="menu-list">
			<li><a href="">首页</a></li>
			<li><a href="">全局</a></li>
			<li><a href="">用户</a></li>
			<li class="current"><a href="">游戏</a></li>
			<li><a href="">资金</a></li>
			<li><a href="">市场促销</a></li>
			<li><a href="">统计</a></li>
			<li><a href="">内容</a></li>
			<li><a href="">权限</a></li>
		</ul>
		<div class="menu-quit"><a href="">退出</a><i class="ico-user"></i>你好，vava</div>
	</div>
	<div class="col-content">
		<div class="col-side">
			<dl class="nav">
				<dt>彩种管理</dt>
				<dd class="current"><a href="">彩种信息列表</a></dd>
				<dt>奖期流程管理</dt>
				<dd><a href="">流程监控</a></dd>
				<dd><a href="#">异常流程记录</a></dd>
				<dt>方案&追号管理</dt>
				<dd><a href="#">方案记录</a></dd>
				<dd><a href="#">追号记录</a></dd>
				<dd><a href="#">异常记录</a></dd>
				<dt>报表管理</dt>
				<dd><a href="#">单期盈亏表</a></dd>
			</dl>
		</div>
		<div class="col-main">
			<div class="col-crumbs"><div class="crumbs"></div></div>
			<div class="col-content">
				<div class="col-main">
					<div class="main">
						<div class="ui-tab">
							<div class="ui-tab-title clearfix">
								<ul>
									<li><a href="1.11.html">奖期规则</a></li>
									<li><a href="1.12.html">奖金组</a></li>
									<li><a href="1.13.html">投注限制</a></li>
									<li class="current"><a href="1.171.html">封锁</a></li>
									<li><a href="1.191.html">变价</a></li>
									<li><a href="1.14.html">玩法描述</a></li>
									<li><a href="1.15.html">销售状态</a></li>
									<li><a href="1.16.html">参数设置</a></li>
								</ul>
							</div>
							<div class="ui-tab-content" id="J-list-container">
							
								<ul class="ui-tab-title clearfix">
									<li><a href="1.171.html">封锁数据</a></li>
									<li class="current"><a href="1.181.html">封锁参数设定</a></li>
								</ul>

								<!--ssq-content-area start-->
								<div id="J-content-info" class="ssq-content-area">
									<div class="tab-title">双色球封锁参数设置项</div>
									<table class="table table-info text-center">
										<thead>
											<tr>
												<th colspan="3">封锁参数设置</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>5红球封锁注数</td>
												<td>蓝球封锁注数</td>
												<td>最大风险值</td>
											</tr>
											<tr>
												<td><input id="J-red-ball" type="text" class="input w-2" value="300"></td>
												<td><input id="J-blue-ball" type="text" class="input w-2" value="10,000"></td>
												<td><span class="tips-area"><span id="maxRNum">4,050,000</span><span class="tips-bonus">小提示：该值值会根据5红球封锁注数和蓝球封锁注数自动得出</span></span></td>
											</tr>
										</tbody>
									</table>	
									<div class="tab-title">封锁详情</div>
									<table class="table table-info text-center">
										<thead>
											<tr>
												<th rowspan="2">奖级</th>
												<th colspan="2">
													中奖条件
												</th>
												<th rowspan="2">封锁注数</th>
												<th rowspan="2">单注奖金</th>
												<th rowspan="2">奖项风险值</th>
											</tr>
											<tr>
												<th>
													红球
												</th>
												<th>
													蓝球
												</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>三等奖</td>
												<td class="text-left">
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
												</td>
												<td>
													<span class="ball blue"></span>
												</td>
												<td id="lv3bets">300</td>
												<td id="lv3Bonus">3,500</td>
												<td id="lv3">1,050,000.00</td>
											</tr>
											<tr>
												<td rowspan="2">四等奖</td>
												<td class="text-left">
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
												</td>
												<td></td>
												<td id="lv41bets">300</td>
												<td id="lv41Bonus">300</td>
												<td id="lv41">90,000.00</td>
											</tr>
											<tr>
												<td class="text-left">
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
												</td>
												<td>
													<span class="ball blue"></span>
												</td>
												<td id="lv42bets">8,400</td>
												<td id="lv42Bonus">300</td>
												<td id="lv42">2,520,000.00</td>
											</tr>
											<tr>
												<td rowspan="2">五等奖</td>
												<td class="text-left">
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
												</td>
												<td></td>
												<td id="lv51bets">8,400</td>
												<td id="lv51Bonus">18</td>
												<td id="lv51">151,200.00</td>
											</tr>
											<tr>
												<td class="text-left">
													<span class="ball red"></span>
													<span class="ball red"></span>
													<span class="ball red"></span>
												</td>
												<td>
													<span class="ball blue"></span>
												</td>
												<td id="lv52bets">10,000</td>
												<td id="lv52Bonus">18</td>
												<td id="lv52">180,000.00</td>
											</tr>
											<tr>
												<td rowspan="3">六等奖</td>
												<td class="text-left">
													<span class="ball red"></span>
													<span class="ball red"></span>
												</td>
												<td>
													<span class="ball blue"></span>
												</td>
												<td id="lv61bets">8,400</td>
												<td id="lv61Bonus">10</td>
												<td id="lv61">100,000.00</td>
											</tr>
											<tr>
												<td class="text-left">
													<span class="ball red"></span>
												</td>
												<td>
													<span class="ball blue"></span>
												</td>
												<td id="lv62bets">10,000</td>
												<td id="lv62Bonus">10</td>
												<td id="lv62">100,000.00</td>
											</tr>
											<tr>
												<td class="text-left"></td>
												<td>
													<span class="ball blue"></span>
												</td>
												<td id="lv63bets">10,000</td>
												<td id="lv63Bonus">10</td>
												<td id="lv63">100,000.00</td>
											</tr>
											<tr>
												<td colspan="5">最大风险值</td>
												<td><strong id="maxnum">4,050,000</strong></td>
											</tr>
										</tbody>
									</table>

									<a id="J-submit-data" class="btn w-3 save-button">保存修改</a>
								</div>	
								<!--ssq-content-area over-->	

								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
<script>
	(function(){
		var msg = new phoenix.Message();
		var formatMoney = function(num){

			if($.trim(num) == ''){
				num = '0';
			}else{
				if(typeof num == 'number'){
					num = num.toString();
				}

				num.replace(/\D/g, '');
			}
			var num = num.replace(/,/g, ''),
				num = parseFloat(num),
				re = /(-?\d+)(\d{3})/;
		
			if(Number.prototype.toFixed){
				num = (num).toFixed(2);
			}else{
				num = Math.round(num*100)/100
			}
			num  =  '' + num;
			while(re.test(num)){
				num = num.replace(re,"$1,$2");
			}
			return num;  
		};

		//封锁数据
		riskData = {
			//红5蓝1
			r5b1: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,
				//奖金
				Bonus: 3500
			},
			//红5
			r5: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,	
				//奖金
				Bonus: 300
			},
			//红4蓝1
			r4b1: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,		
				//奖金
				Bonus: 300
			},
			//红4蓝1
			r4: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,		
				//奖金
				Bonus: 18
			},
			//红3蓝一
			r3b1: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,		
				//奖金
				Bonus: 18
			},
			//红2蓝1
			r2b1: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,		
				//奖金
				Bonus: 10
			},
			//红1蓝1
			r1b1: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,		
				//奖金
				Bonus: 10
			},
			//红1蓝1
			b1: {
				//中奖注数
				betLength: 0,
				//奖项风险值
				RiskNum: 0,	
				//奖金
				Bonus: 10	
			},
			//最大风险值
			maxnum: 0
		}		

		//从dom获取奖金
		var getBonus = function(){

			//r5b1
			riskData['r5b1']['Bonus'] = $('#lv3Bonus').text().replace(/,|[.].*?$/g, '');
			//r5
			riskData['r5']['Bonus'] = $('#lv41Bonus').text().replace(/,|[.].*?$/g, '');
			//r4b1
			riskData['r4b1']['Bonus'] = $('#lv42Bonus').text().replace(/,|[.].*?$/g, '');
			//r4
			riskData['r4']['Bonus'] = $('#lv51Bonus').text().replace(/,|[.].*?$/g, '');
			//r3b1
			riskData['r3b1']['Bonus'] = $('#lv52Bonus').text().replace(/,|[.].*?$/g, '');
			//r2b1
			riskData['r2b1']['Bonus'] = $('#lv61Bonus').text().replace(/,|[.].*?$/g, '');
			//r1b1
			riskData['r1b1']['Bonus'] = $('#lv62Bonus').text().replace(/,|[.].*?$/g, '');
			//b1
			riskData['b1']['Bonus'] = $('#lv63Bonus').text().replace(/,|[.].*?$/g, '');
		}

		var lastModifyed = '',
			firstModify = '',
			lastRed = '',
			lastBlue = '',
			redBall = $('#J-red-ball'),
			blueBall = $('#J-blue-ball');

			redBall.bind('focus', function(){
				firstModify = this.value;
				lastRed = this.value;
				this.value = '';
			})

			blueBall.bind('focus', function(){
				firstModify = this.value;
				blueBall = this.value;
				this.value = '';
			})

			redBall.bind('input', function(){

				if($.trim(this.value)!= ''){
					mathNum();
				}
			});

			blueBall.bind('input', function(){
				if($.trim(this.value)!= ''){
					mathNum();
				}
			});

			redBall.bind('propertychange', function(){
				var info = this.value;


				if(lastModifyed == info) {
					//没有改动
				} else {
					if($.trim(this.value)!= ''){
						mathNum();
					}
				}
				
				lastModifyed = info;
			});

			blueBall.bind('propertychange', function(){
				var info = this.value;

				if(lastModifyed == info) {
					//没有改动
				} else {
					if($.trim(this.value)!= ''){
						mathNum();
					}
				}
				
				lastModifyed = info;
			});

			redBall.bind('blur', function(){
			
				if($.trim(this.value) == ''){
					$(this).val(firstModify);
					return;
				}

				$(this).val(formatMoney(this.value));
			});

			blueBall.bind('blur', function(){
				if($.trim(this.value) == ''){
					$(this).val(firstModify);
					return;
				}

				$(this).val(formatMoney(this.value));
			});
			

		var mathNum = function(){
			var redBall = $('#J-red-ball'),
				blueBall = $('#J-blue-ball'),
				x = parseInt(redBall[0].value.replace(/,|[.].*?$/g, '')),
				y = parseInt(blueBall[0].value.replace(/,|[.].*?$/g, '')),
				minNum = Math.min(x, y);

			//r5b1
			riskData['r5b1']['betLength'] = minNum;
			riskData['r5b1']['RiskNum'] = minNum * riskData['r5b1']['Bonus'];
			//r5
			riskData['r5']['betLength'] = x;
			riskData['r5']['RiskNum'] = x * riskData['r5']['Bonus'];
			//r4b1
			riskData['r4b1']['betLength'] = Math.min(x*28, y);
			riskData['r4b1']['RiskNum'] = Math.min(x*28, y) * riskData['r4b1']['Bonus'];
			//r4
			riskData['r4']['betLength'] = x*28;
			riskData['r4']['RiskNum'] = x*28* riskData['r4']['Bonus'];
			//r3b1
			riskData['r3b1']['betLength'] = Math.min(x*28*27, y);
			riskData['r3b1']['RiskNum'] = Math.min(x*28*27, y) * riskData['r3b1']['Bonus'];
			//r2b1
			riskData['r2b1']['betLength'] = Math.min(x*28*27*26, y);
			riskData['r2b1']['RiskNum'] = Math.min(x*28*27*26, y) * riskData['r2b1']['Bonus'];
			//r1b1
			riskData['r1b1']['betLength'] = Math.min(x*28*27*26*25, y);
			riskData['r1b1']['RiskNum'] = Math.min(x*28*27*26*25, y) * riskData['r1b1']['Bonus'];
			//b1
			riskData['b1']['betLength'] = y;
			riskData['b1']['RiskNum'] = y * riskData['b1']['Bonus'];
			//maxNum
			riskData['maxNum'] = (minNum * riskData['r5b1']['Bonus']) + (Math.min(x*28, y) * riskData['r4b1']['Bonus']) +  (Math.min(x*28*27, y) * riskData['r3b1']['Bonus']) + (Math.min(x*28*27*26, y) * riskData['r2b1']['Bonus'])  +  (Math.min(x*28*27*26*25, y) * riskData['r1b1']['Bonus']) + (y * riskData['b1']['Bonus']);

			if(!$('.tips-bonus').is('hide')){
				$('.tips-bonus').hide();	
			}
		
			inputNum();
		}

		//输出数值
		var inputNum = function(){

			$('#lv3bets').text(formatMoney(riskData['r5b1']['betLength'])),  $('#lv3').text(formatMoney(riskData['r5b1']['RiskNum']));
			$('#lv41bets').text(formatMoney(riskData['r5']['betLength'])),  $('#lv41').text(formatMoney(riskData['r5']['RiskNum']));
			$('#lv42bets').text(formatMoney(riskData['r4b1']['betLength'])),  $('#lv42').text(formatMoney(riskData['r4b1']['RiskNum']));
			$('#lv51bets').text(formatMoney(riskData['r4']['betLength'])),  $('#lv51').text(formatMoney(riskData['r4']['RiskNum']));
			$('#lv52bets').text(formatMoney(riskData['r3b1']['betLength'])),  $('#lv52').text(formatMoney(riskData['r3b1']['RiskNum']));
			$('#lv61bets').text(formatMoney(riskData['r2b1']['betLength'])),  $('#lv61').text(formatMoney(riskData['r2b1']['RiskNum']));
			$('#lv62bets').text(formatMoney(riskData['r1b1']['betLength'])),  $('#lv62').text(formatMoney(riskData['r1b1']['RiskNum']));
			$('#lv63bets').text(formatMoney(riskData['b1']['betLength'])),  $('#lv63').text(formatMoney(riskData['b1']['RiskNum']));
			$('#maxnum,#maxRNum').text(formatMoney(riskData['maxNum']));
		}

		$('#J-submit-data').on('click',function(){

			$.ajax({
				url: 'data.php',
				type: 'POST',
				dataType: 'JSON',
				data: {data: riskData},
			})
			.done(function(r) {

				if(r['isSuccess'] == 1) {
					msg.show({
						content : '<div class="bd">'+
						            '<div class="pop-title">'+
						                '<i class="ico-success"></i>'+
						                '<h4 class="pop-text"> 操作成功</h4>'+
						            '</div>'+
						        '</div>',
						mask: true,
						time : 3
					});
				} else {
					msg.show({
						content : '<div class="bd">'+
						            '<div class="pop-title">'+
						                '<i class="ico-success"></i>'+
						                '<h4 class="pop-text"> 操作失败，请检查网络，并重试</h4>'+
						            '</div>'+
						        '</div>',
						mask: true,
						time : 3
					});
				}
				
			})
			.fail(function() {
				msg.show({
					content : '<div class="bd">'+
					            '<div class="pop-title">'+
					                '<i class="ico-success"></i>'+
					                '<h4 class="pop-text"> 操作失败，请检查网络，并重试</h4>'+
					            '</div>'+
					        '</div>',
					mask: true,
					time : 3
				});
			})
			.always(function() {
				
			});
			
			
		});

		$(function(){
			getBonus();
		});
	})();
</script>
</html>